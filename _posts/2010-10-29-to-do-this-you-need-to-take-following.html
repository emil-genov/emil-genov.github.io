---
layout: post
title: Tagging maven build with SVN version, and using this version inside application
date: '2010-10-29T11:07:00.007+03:00'
author: Emo
tags: 
modified_time: '2010-10-29T11:27:57.027+03:00'
blogger_id: tag:blogger.com,1999:blog-7542889160674991776.post-579425030727603663
blogger_orig_url: http://www.emil-genov.info/2010/10/to-do-this-you-need-to-take-following.html
---

To do this, you need to take following steps:<br /><ol><li>Add build-number plugin to your project main POM<br /><pre>...<br />      &lt;build&gt;<br />              ...<br />              &lt;plugins&gt;<br />                  ...<br />                  &lt;plugin&gt;<br />                      &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;<br />                      &lt;artifactId&gt;buildnumber-maven-plugin&lt;/artifactId&gt;<br />                      &lt;version&gt;1.0-beta-3&lt;/version&gt;<br />                      &lt;executions&gt;<br />                          &lt;execution&gt;<br />                              &lt;phase&gt;validate&lt;/phase&gt;<br />                              &lt;goals&gt;<br />                                  &lt;goal&gt;create&lt;/goal&gt;<br />                              &lt;/goals&gt;<br />                          &lt;/execution&gt;<br />                      &lt;/executions&gt;<br />                      &lt;configuration&gt;<br />                          &lt;doCheck&gt;false&lt;/doCheck&gt;<br />                          &lt;doUpdate&gt;false&lt;/doUpdate&gt;<br />                      &lt;/configuration&gt;<br />                  &lt;/plugin&gt;<br />                  &lt;plugin&gt;<br />                      &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;<br />                      &lt;artifactId&gt;maven-release-plugin&lt;/artifactId&gt;<br />                      &lt;version&gt;2.0&lt;/version&gt;<br />                  &lt;/plugin&gt;<br />                  ...<br />              &lt;/plugins&gt;<br />          ...<br />      &lt;/build&gt;<br />      ...<br /></pre></li><li>Change your current jar plugin (or add one if such is missing):<br /><pre>...<br />                   &lt;plugin&gt;<br />                      &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;<br />                      &lt;version&gt;2.2-beta-2&lt;/version&gt;<br />                      &lt;configuration&gt;<br />                          &lt;archive&gt;<br />                              ...<br />                              &lt;manifest&gt;<br />                                  ...    <br />                                  &lt;addDefaultImplementationEntries&gt;true&lt;/addDefaultImplementationEntries&gt;<br />                                  ...<br />                              &lt;/manifest&gt;<br />                              &lt;manifestEntries&gt;<br />                                  &lt;Implementation-Version&gt;${pom.version} (SVN version:${buildNumber})&lt;/Implementation-Version&gt;<br />                                  &lt;SVN-Version&gt;${buildNumber}&lt;/SVN-Version&gt;<br />                              &lt;/manifestEntries&gt;<br />                              ...<br />                          &lt;/archive&gt;<br />                          ...<br />                      &lt;/configuration&gt;<br />                      &lt;executions&gt;<br />                          &lt;execution&gt;<br />                              &lt;goals&gt;<br />                                  &lt;goal&gt;single&lt;/goal&gt;<br />                              &lt;/goals&gt;<br />                              &lt;phase&gt;package&lt;/phase&gt;<br />                          &lt;/execution&gt;<br />                      &lt;/executions&gt;<br />                  &lt;/plugin&gt;<br />                  ...<br /></pre></li><li>To get version inside your code use: <pre>public String getVersion() {<br />    return &lt;some class inside jar, that is created by maven&gt;.class.getPackage().getImplementationVersion();<br />}<br /></pre></li><li><br />To get version from running program (server) using only command line:<br /><ol><li>Create an JMX interface, with method getVersion() exposed, expose this interface in JMX on host XXX.YYY.ZZZ on port PPP</li><li>Download <a href="http://crawler.archive.org/cmdline-jmxclient/cmdline-jmxclient-0.10.3.jar">cmdline-jmxclient utility jar from it's site</a></li><li>Issue this:<br /><pre>java -jar cmdline-jmxclient-0.10.3.jar a:a  XXX.YYY.ZZZ:PPP &lt;name of your JMX bean&gt; Version<br /></pre></li></ol></li></ol>